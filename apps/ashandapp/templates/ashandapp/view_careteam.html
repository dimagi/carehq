{% extends "base.html" %}
{% load i18n %}
{% block title %}{% trans "Care Team View" %} {% endblock %}
{% block extrahead %}
<script type="text/javascript"> 
            $(function(){                
                // Tabs
                $('#tabs').tabs();                
                });
</script>
{% endblock %}

{% block content %}

{%with current_careteam as careteam %}
{# pulling from the inline_careteam but we want to custom display it here #}
<div class="span-24">
<div class="span-18"> <!-- careteam header -->    
 <h3>{{careteam.patient.user.first_name}} {{careteam.patient.user.last_name}}'s Care Team</h3>
 <table>
     <tr>
        <th>Profile</th>
        <th>DOB</th>
        <th>Sex</th>
        <th>Primary Provider</th> 
     </tr>
     <tr>     
        <td><a href="{%url ashandapp.views.users.single careteam.patient.user.id %}">{%trans "View Profile"%}</a>
        <td>{{careteam.patient.dob|date}}</td> 
        <td>{{careteam.patient.get_sex_display}}</td>
        <td>
            {% if careteam.primary_provider %}
                <a href="{%url ashandapp.views.users.single careteam.primary_provider.user.id %}">{{careteam.primary_provider.user.first_name}} {{careteam.primary_provider.user.last_name}}</a>
            {% else %}
                Not Set
            {% endif %}
        </td>
    </tr> 
</table>
</div> <!-- end careteam header -->
{%endwith %}
<div class="span-6 last">
<h4>Actions</h4>
<a href="{%url ashandapp.views.cases.create.new_question current_careteam.id %}" class="fg-button ui-state-default ui-corner-all">New Question</a><br><br>
<a href="{%url ashandapp.views.cases.create.new_issue current_careteam.id %}" class="fg-button ui-state-default ui-corner-all">New Issue</a><br><br>
<br>
<a href="" class="fg-button ui-state-default ui-corner-all">Invite provider</a><br><br>
<a href="" class="fg-button ui-state-default ui-corner-all">Invite caregiver</a><br>
<br><br>
</div>

</div>


<div id="tabs" class="span-24"> 
    <ul> 
        <li><a href="#tabs-1">Care Team</a></li>         
        <li><a href="#tabs-2">Care Plan</a></li>
        <li><a href="{% url ashandapp.views.careteam.ajax.view_careteam_cases current_careteam.id %}">Cases</a></li>
    </ul> 
    <div id="tabs-1">
        {% with current_careteam as careteam %}
        <div class="span-24"><!-- careteam tab block -->
            <div class="span-9"><!--provider block -->
                <h3>{%trans "Providers" %}</h3>                
                <ul class="span-12">
                {% for prov in careteam.providers.all %}
                    <li>            
                        <a href="{%url ashandapp.views.users.single prov.user.id %}">
                        {{prov.user.first_name }}  {{prov.user.last_name }}</a><br>
                        <em>{{prov.job_title }} with {{prov.affiliation }}</em> <br>
                    </li>
                {% endfor %}
                </ul>
            </div> <!-- end provider block -->
        
            <div class="span-9"> <!-- caregiver block -->
            <h3>{%trans "Caregivers"%}</h3>         
            {% if careteam.caregiver_data %}
                <ul>
                {% for cglink in careteam.caregiver_data %}
                    <li>
                        <a href="{%url ashandapp.views.users.single cglink.user.id %}">
                        {{cglink.user.first_name }}  {{cglink.user.last_name }}</a><br>
                        <em>{{cglink.relationship }}</em> 
                    </li>
                {% endfor %}
                </ul>
            {%else %}
                <em>{%trans "No Caregivers"%}</em>
            {%endif %}    
            </div> <!-- end caregiver block -->
            
            <div class="span-6 last">            
            
            </div>
            
        </div> <!-- end careteam tab block -->
        {%endwith %}
        
    </div> <!-- end tabs-1 -->    
    <div id="tabs-2">
        {# {{careplan}}#} 
         
         <h2>{{careplan.title}}</h2>
            <dl>
                <dt>Created by:</dt> <dd>{{careplan.created_by.get_full_name}}</dd>
                <dt>Created date:</dt> <dd>{{careplan.created_date|date}}</dd>    
            </dl>
            <ul>
            {% for itemlink in plan_items %}
                {% with itemlink.item  as plan_item %}    
                    {% include "careplan/partials/compact_careplan_item_li.html" %}    
                {%endwith%}
            {%endfor%}
            </ul> 
    </div>
    
</div> <!-- end tabs -->

{% endblock %}
